#!/bin/bash
#SBATCH --job-name=processing_array
#SBATCH --time=7-00:00:00
#SBATCH --mem=10240
#SBATCH --partition=dark
#SBATCH --nodelist=darkside1,darkside2
#SBATCH --array=0-89%200

# Embed the ALL_PATHS array directly into the script
declare -a ALL_PATHS=(/mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/chapman_shaoxing/g1 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/chapman_shaoxing/g10 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/chapman_shaoxing/g11 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/chapman_shaoxing/g2 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/chapman_shaoxing/g3 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/chapman_shaoxing/g4 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/chapman_shaoxing/g5 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/chapman_shaoxing/g6 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/chapman_shaoxing/g7 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/chapman_shaoxing/g8 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/chapman_shaoxing/g9 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/cpsc_2018/g1 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/cpsc_2018/g2 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/cpsc_2018/g3 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/cpsc_2018/g4 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/cpsc_2018/g5 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/cpsc_2018/g6 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/cpsc_2018/g7 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/cpsc_2018_extra/g1 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/cpsc_2018_extra/g2 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/cpsc_2018_extra/g3 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/cpsc_2018_extra/g4 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/georgia/g1 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/georgia/g10 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/georgia/g11 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/georgia/g2 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/georgia/g3 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/georgia/g4 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/georgia/g5 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/georgia/g6 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/georgia/g7 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/georgia/g8 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/georgia/g9 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g1 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g10 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g11 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g12 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g13 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g14 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g15 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g16 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g17 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g18 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g19 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g2 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g20 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g21 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g22 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g23 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g24 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g25 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g26 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g27 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g28 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g29 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g3 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g30 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g31 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g32 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g33 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g34 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g35 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g4 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g5 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g6 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g7 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g8 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ningbo/g9 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g1 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g10 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g11 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g12 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g13 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g14 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g15 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g16 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g17 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g18 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g19 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g2 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g20 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g21 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g22 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g3 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g4 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g5 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g6 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g7 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g8 /mnt/processed1/signals/datasets/CINC_2021_REMOVE_USELESS_DATASETS/training/ptb-xl/g9)

echo "Running job array task with SLURM_ARRAY_TASK_ID: $SLURM_ARRAY_TASK_ID"

# Fetch the directory path from the array
DIR_PATH="${ALL_PATHS[$SLURM_ARRAY_TASK_ID]}"
OUTPUT_DIR="${DIR_PATH/#\/mnt\/processed1\/signals\/datasets\/CINC_2021_REMOVE_USELESS_DATASETS\/training//mnt/processed2/signals/cinc2021_image/documents/CINC_CHALLENGE_2024/GENERATED_IMG/CINC21/1_None}"
mkdir -p "$OUTPUT_DIR"

sleep $((SLURM_ARRAY_TASK_ID * 20)) 

echo "Processing ${DIR_PATH} into ${OUTPUT_DIR}"
echo "Args: --store_text_bounding_box --store_config --bbox --augment -noise 40 --x_offset 30 --y_offset 20 --wrinkles -ca 45 --random_dc 0.5 --random_grid_present 0.95 --random_add_header 0.8 -r 100 --random_grid_color -se 10 --augment --num_columns 1 --full_mode None"
bash gen_img_base.sh --input "${DIR_PATH}" --output "${OUTPUT_DIR}" --store_text_bounding_box --store_config --bbox --augment -noise 40 --x_offset 30 --y_offset 20 --wrinkles -ca 45 --random_dc 0.5 --random_grid_present 0.95 --random_add_header 0.8 -r 100 --random_grid_color -se 10 --augment --num_columns 1 --full_mode None
